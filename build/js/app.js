"use strict";var _createClass=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var scrollTo=function(s,l){var r=document.scrollingElement||document.documentElement,a=r.scrollTop,c=s-a,u=+new Date;!function e(){var t,i,n,o=+new Date-u;r.scrollTop=parseInt((t=o,i=a,n=c,(t/=l/2)<1?n/2*t*t+i:-n/2*(--t*(t-2)-1)+i)),o<l?requestAnimationFrame(e):r.scrollTop=s}()};function slideDown(t,e){e=e||"300ms ease",t.style.webkitTransition="initial",t.style.transition="initial",t.style.visibility="hidden",t.style.maxHeight="initial";var i=t.offsetHeight+"px";t.style.removeProperty("visibility"),t.style.maxHeight="0",t.style.overflow="hidden",t.style.webkitTransition="max-height "+e+", opacity "+e,t.style.transition="max-height "+e+", opacity "+e;var n=function e(){t.style.removeProperty("-webkit-transition"),t.style.removeProperty("transition"),t.style.removeProperty("opacity"),t.removeEventListener("transitionend",e)};requestAnimationFrame(function(){t.addEventListener("transitionend",n),t.style.maxHeight=i,t.style.opacity="1"})}function slideUp(t,e){e=e||"300ms ease",t.style.webkitTransition="initial",t.style.transition="initial";var i=t.offsetHeight+"px";t.style.maxHeight=i,t.style.overflow="hidden",t.style.webkitTransition="max-height "+e+", opacity "+e,t.style.transition="max-height "+e+", opacity "+e;var n=function e(){t.style.removeProperty("-webkit-transition"),t.style.removeProperty("transition"),t.style.removeProperty("opacity"),t.removeEventListener("transitionend",e)};requestAnimationFrame(function(){t.addEventListener("transitionend",n),t.style.maxHeight="0",t.style.opacity="0"})}Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}),window.viewportSize={},window.viewportSize.getHeight=function(){return getSize("Height")},window.viewportSize.getWidth=function(){return getSize("Width")};var getSize=function(e){var t,i=e.toLowerCase(),n=window.document,o=n.documentElement;if(void 0===window["inner"+e])t=o["client"+e];else if(window["inner"+e]!=o["client"+e]){var s=n.createElement("body");s.id="vpw-test-b",s.style.cssText="overflow:scroll";var l=n.createElement("div");l.id="vpw-test-d",l.style.cssText="position:absolute;top:-1000px",l.innerHTML="<style>@media("+i+":"+o["client"+e]+"px){body#vpw-test-b div#vpw-test-d{"+i+":7px!important}}</style>",s.appendChild(l),o.insertBefore(s,n.head),t=7==l["offset"+e]?o["client"+e]:window["inner"+e],o.removeChild(s)}else t=window["inner"+e];return t},Dropdown=function(){function t(e){_classCallCheck(this,t),this.container=e,this.contents=this.container.querySelectorAll(".js-dropdown-item-content"),this.links=this.container.querySelectorAll(".js-dropdown-item-link"),this.init()}return _createClass(t,[{key:"init",value:function(){this.container.addEventListener("click",this.updateDropdown.bind(this))}},{key:"updateDropdown",value:function(e){var t=e.target;if(t.classList.contains("js-dropdown-item-link")){e.preventDefault();var i=t.closest(".js-dropdown-item").querySelector(".js-dropdown-item-content");t.classList.contains("is-active")?this.clearDropdown():(this.clearDropdown(),t.classList.add("is-active"),slideDown(i))}}},{key:"clearDropdown",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,o=this.links[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){n.value.classList.remove("is-active")}}catch(e){t=!0,i=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw i}}var s=!0,l=!1,r=void 0;try{for(var a,c=this.contents[Symbol.iterator]();!(s=(a=c.next()).done);s=!0){slideUp(a.value)}}catch(e){l=!0,r=e}finally{try{!s&&c.return&&c.return()}finally{if(l)throw r}}}}]),t}(),Menu=function(){function t(e){_classCallCheck(this,t),this.container=e,this.menuScroll=this.container.querySelector(".js-menu-scroll"),this.menuScrollTarget=document.querySelector(".js-menu-show"),this.menuMobile=this.container.querySelector(".js-menu-mobile"),this.menuMobileToggle=this.container.querySelector(".js-menu-mobile-toggle"),this.init()}return _createClass(t,[{key:"init",value:function(){window.addEventListener("scroll",this.checkMenuPosition.bind(this)),window.addEventListener("resize",this.checkMenuPosition.bind(this)),document.body.addEventListener("click",this.scrollToElement.bind(this)),this.menuMobileToggle.addEventListener("click",this.toggleMobileMenu.bind(this))}},{key:"checkMenuPosition",value:function(){this.menuScrollTarget.getBoundingClientRect().top<0?this.menuScroll.classList.add("is-active"):this.menuScroll.classList.remove("is-active")}},{key:"scrollToElement",value:function(e){var t=e.target;if(t.classList.contains("js-menu-link-scroll")){e.preventDefault();var i=65;t.classList.contains("js-menu-link-scroll-no-menu")&&(i=0);var n=document.querySelector(t.getAttribute("href")).getBoundingClientRect().top+window.pageYOffset-i;scrollTo(n,1e3),this.menuMobileToggle.classList.remove("is-active"),this.menuMobile.classList.remove("is-active"),document.body.classList.remove("menu-opened")}}},{key:"toggleMobileMenu",value:function(e){e.preventDefault();var t=this.menuMobileToggle.classList,i=this.menuMobile.classList,n=document.body.classList;t.contains("is-active")?(t.remove("is-active"),i.remove("is-active"),n.remove("menu-opened")):(t.add("is-active"),i.add("is-active"),n.add("menu-opened"))}}]),t}(),SlideToggle=function(){function t(e){_classCallCheck(this,t),this.container=e,this.content=this.container.querySelector(".js-slideToggle-content"),this.button=this.container.querySelector(".js-slideToggle-button"),this.WIDTH_MOBILE=767,this.init()}return _createClass(t,[{key:"init",value:function(){this.button.addEventListener("click",this.toggleContent.bind(this)),window.addEventListener("resize",this.checkTogglePosition.bind(this))}},{key:"toggleContent",value:function(e){e.preventDefault();var t=this.button.classList,i=this.content.classList;t.contains("is-active")?(i.remove("is-active"),t.remove("is-active"),this.button.textContent="показать все",slideUp(this.content)):(i.add("is-active"),t.add("is-active"),this.button.textContent="скрыть",slideDown(this.content))}},{key:"checkTogglePosition",value:function(){}}]),t}(),Toggle=function(){function e(){_classCallCheck(this,e),this.init()}return _createClass(e,[{key:"init",value:function(){document.body.addEventListener("click",this.toggleSwitch.bind(this))}},{key:"toggleSwitch",value:function(e){var t=e.target,i=t.classList;if(i.contains("js-toggle-link")){e.preventDefault();var n=t.closest(".js-toggle-container").querySelector(".js-toggle-content"),o=n.classList;i.contains("is-active")?(i.remove("is-active"),o.remove("is-active"),n.style.maxHeight="0"):(i.add("is-active"),o.add("is-active"),n.style.maxHeight="none")}}}]),e}(),Tooltips=function(){function e(){_classCallCheck(this,e),this.tooltipContents=document.body.querySelectorAll(".js-tooltip-content"),this.tooltipLinks=document.body.querySelectorAll(".js-tooltip-link"),this.init()}return _createClass(e,[{key:"init",value:function(){document.body.addEventListener("click",this.toggleTooltip.bind(this))}},{key:"toggleTooltip",value:function(e){var t=e.target;if(t.classList.contains("js-tooltip-link")){e.preventDefault();var i=t.closest(".js-tooltip-container").querySelector(".js-tooltip-content");t.classList.contains("is-active")?this.clearTooltips():(this.clearTooltips(),t.classList.add("is-active"),i.classList.add("is-active"))}else this.clearTooltips()}},{key:"clearTooltips",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,o=this.tooltipContents[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){n.value.classList.remove("is-active")}}catch(e){t=!0,i=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw i}}var s=!0,l=!1,r=void 0;try{for(var a,c=this.tooltipLinks[Symbol.iterator]();!(s=(a=c.next()).done);s=!0){a.value.classList.remove("is-active")}}catch(e){l=!0,r=e}finally{try{!s&&c.return&&c.return()}finally{if(l)throw r}}}}]),e}(),Viewer=function(){function e(){_classCallCheck(this,e),this.init()}return _createClass(e,[{key:"init",value:function(){this.initClasses()}},{key:"initClasses",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,o=document.querySelectorAll(".js-dropdown-container")[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var s=n.value;new Dropdown(s)}}catch(e){t=!0,i=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw i}}var l=!0,r=!1,a=void 0;try{for(var c,u=document.querySelectorAll(".js-menu-container")[Symbol.iterator]();!(l=(c=u.next()).done);l=!0){s=c.value;new Menu(s)}}catch(e){r=!0,a=e}finally{try{!l&&u.return&&u.return()}finally{if(r)throw a}}var d=!0,v=!1,h=void 0;try{for(var y,m=document.querySelectorAll(".js-slideToggle-container")[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){s=y.value;new SlideToggle(s)}}catch(e){v=!0,h=e}finally{try{!d&&m.return&&m.return()}finally{if(v)throw h}}document.querySelectorAll(".js-tooltip-link").length&&new Tooltips,document.querySelectorAll(".js-toggle-link").length&&new Toggle}}]),e}();document.addEventListener("DOMContentLoaded",function(){new Viewer});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJzY3JvbGxUbyIsInRvIiwiZHVyYXRpb24iLCJlbGVtZW50IiwiZG9jdW1lbnQiLCJzY3JvbGxpbmdFbGVtZW50IiwiZG9jdW1lbnRFbGVtZW50Iiwic3RhcnQiLCJzY3JvbGxUb3AiLCJjaGFuZ2UiLCJzdGFydERhdGUiLCJEYXRlIiwiZWFzZUluT3V0UXVhZCIsInQiLCJiIiwiYyIsImN1cnJlbnRUaW1lIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYW5pbWF0ZVNjcm9sbCIsImN1cnJlbnREYXRlIiwic2xpZGVEb3duIiwiZWwiLCJ0aW1pbmciLCJzdHlsZSIsInRyYW5zaXRpb24iLCJ2aXNpYmlsaXR5Iiwid2Via2l0VHJhbnNpdGlvbiIsIm1heEhlaWdodCIsImhlaWdodCIsIm9mZnNldEhlaWdodCIsIm92ZXJmbG93IiwiZW5kU2xpZGVEb3duIiwicmVtb3ZlUHJvcGVydHkiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2xpZGVVcCIsIkVsZW1lbnQiLCJwcm90b3R5cGUiLCJtYXRjaGVzIiwibXNNYXRjaGVzU2VsZWN0b3IiLCJ3ZWJraXRNYXRjaGVzU2VsZWN0b3IiLCJjbG9zZXN0IiwicyIsImNvbnRhaW5zIiwibm9kZVR5cGUiLCJ3aW5kb3ciLCJ2aWV3cG9ydFNpemUiLCJnZXRIZWlnaHQiLCJnZXRTaXplIiwiZ2V0V2lkdGgiLCJOYW1lIiwic2l6ZSIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsInVuZGVmaW5lZCIsImJvZHlFbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiZGl2RWxlbWVudCIsImNzc1RleHQiLCJhcHBlbmRDaGlsZCIsImlubmVySFRNTCIsImhlYWQiLCJpbnNlcnRCZWZvcmUiLCJyZW1vdmVDaGlsZCIsIkRyb3Bkb3duIiwiY29udGFpbmVyIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjb250ZW50cyIsImxpbmtzIiwiYWRkRXZlbnRMaXN0ZW5lciIsInVwZGF0ZURyb3Bkb3duIiwiYmluZCIsInRhcmdldCIsImUiLCJjbGFzc0xpc3QiLCJwcmV2ZW50RGVmYXVsdCIsImNvbnRlbnQiLCJxdWVyeVNlbGVjdG9yIiwicGFyZW50IiwiY2xlYXJEcm9wZG93biIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwidmFsdWUiLCJyZW1vdmUiLCJlcnIiLCJyZXR1cm4iLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9pdGVyYXRvcjIiLCJNZW51IiwibWVudVNjcm9sbCIsIm1lbnVTY3JvbGxUYXJnZXQiLCJtZW51TW9iaWxlVG9nZ2xlIiwiaW5pdCIsImNoZWNrTWVudVBvc2l0aW9uIiwiYm9keSIsInNjcm9sbFRvRWxlbWVudCIsInRvZ2dsZU1vYmlsZU1lbnUiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJhZGQiLCJtZW51X2hlaWdodCIsInRhcmdldFBvc2l0aW9uVG9wIiwiZ2V0QXR0cmlidXRlIiwicGFnZVlPZmZzZXQiLCJtZW51TW9iaWxlIiwidGFyZ2V0Q2xhc3NMaXN0IiwibWVudUNsYXNzTGlzdCIsImJvZHlDbGFzc0xpc3QiLCJTbGlkZVRvZ2dsZSIsImJ1dHRvbiIsIldJRFRIX01PQklMRSIsInRhcmdldFBvc2l0aW9uIiwidG9nZ2xlQ29udGVudCIsImNoZWNrVG9nZ2xlUG9zaXRpb24iLCJidXR0b25DbGFzc0xpc3QiLCJjb250ZW50Q2xhc3NMaXN0IiwidGV4dENvbnRlbnQiLCJUb2dnbGUiLCJ0b2dnbGVTd2l0Y2giLCJUb29sdGlwcyIsInRvZ2dsZVRvb2x0aXAiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyIsIl9kaWRJdGVyYXRvckVycm9yMyIsIl9pdGVyYXRvckVycm9yMyIsIl9zdGVwMyIsIl9pdGVyYXRvcjMiLCJ0b29sdGlwQ29udGVudHMiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCIsIl9kaWRJdGVyYXRvckVycm9yNCIsIl9pdGVyYXRvckVycm9yNCIsIl9zdGVwNCIsIl9pdGVyYXRvcjQiLCJ0b29sdGlwTGlua3MiLCJWaWV3ZXIiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNSIsIl9kaWRJdGVyYXRvckVycm9yNSIsIl9pdGVyYXRvckVycm9yNSIsIl9zdGVwNSIsIl9pdGVyYXRvcjUiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNiIsIl9kaWRJdGVyYXRvckVycm9yNiIsIl9pdGVyYXRvckVycm9yNiIsIl9zdGVwNiIsIl9pdGVyYXRvcjYiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNyIsIl9kaWRJdGVyYXRvckVycm9yNyIsIl9pdGVyYXRvckVycm9yNyIsIl9zdGVwNyIsIl9pdGVyYXRvcjciLCJsZW5ndGgiXSwibWFwcGluZ3MiOiI2WEFHRSxJQUFNQSxTQUFXLFNBQVNDLEVBQUlDLEdBQzVCLElBQ0FDLEVBQVVDLFNBQVNDLGtCQUFvQkQsU0FBU0UsZ0JBTHBEQyxFQUFBSixFQUFBSyxVQU9JQyxFQUFTUixFQUFLTSxFQUNkRyxHQUFhLElBQUlDLE1BS0QsU0FBaEJDLElBQ0VDLElBVkZBLEVBQUFDLEVBQUFDLEVBV1VDLEdBRFIsSUFBQUwsS0FDV0QsRUFDWEcsRUFBQUEsVUFBQUEsVUFaRkEsRUFZRUEsRUFaRkMsRUFZRUQsRUFaRkUsRUFZRUYsR0FGQUEsR0FFQUEsRUFGTyxHQUxULEVBQUFFLEVBQUEsRUFBQUYsRUFBQUEsRUFBQUMsR0FFQUMsRUFBQSxLQURBRixHQUNBQSxFQUFBLEdBQUEsR0FBQUMsSUFNRUUsRUFBZUgsRUFiakJJLHNCQUFBQyxHQWdCUUMsRUFBQUEsVUFBbUJSLEVBR3pCTyxJQTZCSixTQUFTRSxVQUFVQyxFQUFJQyxHQUNyQkEsRUFBU0EsR0FBVSxhQUFuQkEsRUFBQUEsTUFBU0Es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cHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogVGhpcmQgcGFydHlcbiAqL1xuICBjb25zdCBzY3JvbGxUbyA9IGZ1bmN0aW9uKHRvLCBkdXJhdGlvbikge1xuICAgIGNvbnN0XG4gICAgZWxlbWVudCA9IGRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFxuICAgIHN0YXJ0ID0gZWxlbWVudC5zY3JvbGxUb3AsXG4gICAgY2hhbmdlID0gdG8gLSBzdGFydCxcbiAgICBzdGFydERhdGUgPSArbmV3IERhdGUoKSxcbiAgICAvLyB0ID0gY3VycmVudCB0aW1lXG4gICAgLy8gYiA9IHN0YXJ0IHZhbHVlXG4gICAgLy8gYyA9IGNoYW5nZSBpbiB2YWx1ZVxuICAgIC8vIGQgPSBkdXJhdGlvblxuICAgIGVhc2VJbk91dFF1YWQgPSBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgICB0IC89IGQvMjtcbiAgICAgIGlmICh0IDwgMSkgcmV0dXJuIGMvMip0KnQgKyBiO1xuICAgICAgdC0tO1xuICAgICAgcmV0dXJuIC1jLzIgKiAodCoodC0yKSAtIDEpICsgYjtcbiAgICB9LFxuICAgIGFuaW1hdGVTY3JvbGwgPSBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IGN1cnJlbnREYXRlID0gK25ldyBEYXRlKCk7XG4gICAgICBjb25zdCBjdXJyZW50VGltZSA9IGN1cnJlbnREYXRlIC0gc3RhcnREYXRlO1xuICAgICAgZWxlbWVudC5zY3JvbGxUb3AgPSBwYXJzZUludChlYXNlSW5PdXRRdWFkKGN1cnJlbnRUaW1lLCBzdGFydCwgY2hhbmdlLCBkdXJhdGlvbikpO1xuICAgICAgaWYgKGN1cnJlbnRUaW1lIDwgZHVyYXRpb24pIHtcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGVTY3JvbGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5zY3JvbGxUb3AgPSB0bztcbiAgICAgIH1cbiAgICB9O1xuICAgIGFuaW1hdGVTY3JvbGwoKTtcbiAgfTtcbiAgaWYgKCFFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzKVxuICAgICAgRWxlbWVudC5wcm90b3R5cGUubWF0Y2hlcyA9IEVsZW1lbnQucHJvdG90eXBlLm1zTWF0Y2hlc1NlbGVjdG9yIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRWxlbWVudC5wcm90b3R5cGUud2Via2l0TWF0Y2hlc1NlbGVjdG9yO1xuICBcbiAgaWYgKCFFbGVtZW50LnByb3RvdHlwZS5jbG9zZXN0KVxuICAgICAgRWxlbWVudC5wcm90b3R5cGUuY2xvc2VzdCA9IGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICB2YXIgZWwgPSB0aGlzO1xuICAgICAgICAgIGlmICghZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zKGVsKSkgcmV0dXJuIG51bGw7XG4gICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICBpZiAoZWwubWF0Y2hlcyhzKSkgcmV0dXJuIGVsO1xuICAgICAgICAgICAgICBlbCA9IGVsLnBhcmVudEVsZW1lbnQgfHwgZWwucGFyZW50Tm9kZTtcbiAgICAgICAgICB9IHdoaWxlIChlbCAhPT0gbnVsbCAmJiBlbC5ub2RlVHlwZSA9PT0gMSk7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9O1xuICAvKipcbiAgICogU2xpZGUgYW4gZWxlbWVudCBkb3duIGxpa2UgalF1ZXJ5J3Mgc2xpZGVEb3duIGZ1bmN0aW9uIHVzaW5nIENTUzMgdHJhbnNpdGlvbnMuXG4gICAqIEBzZWUgaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vbHVkZGVyLzQyMjYyODhcbiAgICogQHBhcmFtICB7ZWxlbWVudH0gIGVsXG4gICAqIEBwYXJhbSAge3N0cmluZ30gICB0aW1pbmdcbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIGZ1bmN0aW9uIHNsaWRlRG93bihlbCwgdGltaW5nKSB7XG4gICAgdGltaW5nID0gdGltaW5nIHx8ICczMDBtcyBlYXNlJztcbiAgXG4gICAgLy8gR2V0IGVsZW1lbnQgaGVpZ2h0XG4gICAgZWwuc3R5bGUud2Via2l0VHJhbnNpdGlvbiA9ICdpbml0aWFsJztcbiAgICBlbC5zdHlsZS50cmFuc2l0aW9uID0gJ2luaXRpYWwnO1xuICAgIGVsLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICBlbC5zdHlsZS5tYXhIZWlnaHQgPSAnaW5pdGlhbCc7XG4gICAgdmFyIGhlaWdodCA9IGVsLm9mZnNldEhlaWdodCArICdweCc7XG4gICAgZWwuc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3Zpc2liaWxpdHknKTtcbiAgICBlbC5zdHlsZS5tYXhIZWlnaHQgPSAnMCc7XG4gICAgZWwuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgXG4gICAgLy8gQmVnaW4gdHJhbnNpdGlvblxuICAgIGVsLnN0eWxlLndlYmtpdFRyYW5zaXRpb24gPSAnbWF4LWhlaWdodCAnICsgdGltaW5nICsgJywgb3BhY2l0eSAnICsgdGltaW5nICsgJyc7XG4gICAgZWwuc3R5bGUudHJhbnNpdGlvbiA9ICdtYXgtaGVpZ2h0ICcgKyB0aW1pbmcgKyAnLCBvcGFjaXR5ICcgKyB0aW1pbmcgKyAnJztcbiAgICB2YXIgZW5kU2xpZGVEb3duID0gZnVuY3Rpb24oKSB7XG4gICAgICBlbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnLXdlYmtpdC10cmFuc2l0aW9uJyk7XG4gICAgICBlbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgndHJhbnNpdGlvbicpO1xuICAgICAgZWwuc3R5bGUucmVtb3ZlUHJvcGVydHkoJ29wYWNpdHknKTtcbiAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBlbmRTbGlkZURvd24pO1xuICAgIH07XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsIGVuZFNsaWRlRG93bik7XG4gICAgICBlbC5zdHlsZS5tYXhIZWlnaHQgPSBoZWlnaHQ7XG4gICAgICBlbC5zdHlsZS5vcGFjaXR5ID0gJzEnO1xuICAgIH0pO1xuICB9XG4gIFxuICAvKipcbiAgICogU2xpZGUgYW4gZWxlbWVudCB1cCBsaWtlIGpRdWVyeSdzIHNsaWRlVXAgZnVuY3Rpb24gdXNpbmcgQ1NTMyB0cmFuc2l0aW9ucy5cbiAgICogQHNlZSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9sdWRkZXIvNDIyNjI4OFxuICAgKiBAcGFyYW0gIHtlbGVtZW50fSAgZWxcbiAgICogQHBhcmFtICB7c3RyaW5nfSAgIHRpbWluZ1xuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgZnVuY3Rpb24gc2xpZGVVcChlbCwgdGltaW5nKSB7XG4gICAgdGltaW5nID0gdGltaW5nIHx8ICczMDBtcyBlYXNlJztcbiAgXG4gICAgLy8gR2V0IGVsZW1lbnQgaGVpZ2h0XG4gICAgZWwuc3R5bGUud2Via2l0VHJhbnNpdGlvbiA9ICdpbml0aWFsJztcbiAgICBlbC5zdHlsZS50cmFuc2l0aW9uID0gJ2luaXRpYWwnO1xuICAgIHZhciBoZWlnaHQgPSBlbC5vZmZzZXRIZWlnaHQgKyAncHgnO1xuICAgIGVsLnN0eWxlLm1heEhlaWdodCA9IGhlaWdodDtcbiAgICBlbC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuICBcbiAgICAvLyBCZWdpbiB0cmFuc2l0aW9uXG4gICAgZWwuc3R5bGUud2Via2l0VHJhbnNpdGlvbiA9ICdtYXgtaGVpZ2h0ICcgKyB0aW1pbmcgKyAnLCBvcGFjaXR5ICcgKyB0aW1pbmcgKyAnJztcbiAgICBlbC5zdHlsZS50cmFuc2l0aW9uID0gJ21heC1oZWlnaHQgJyArIHRpbWluZyArICcsIG9wYWNpdHkgJyArIHRpbWluZyArICcnO1xuICAgIHZhciBlbmRTbGlkZURvd24gPSBmdW5jdGlvbigpIHtcbiAgICAgIGVsLnN0eWxlLnJlbW92ZVByb3BlcnR5KCctd2Via2l0LXRyYW5zaXRpb24nKTtcbiAgICAgIGVsLnN0eWxlLnJlbW92ZVByb3BlcnR5KCd0cmFuc2l0aW9uJyk7XG4gICAgICBlbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnb3BhY2l0eScpO1xuICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsIGVuZFNsaWRlRG93bik7XG4gICAgfTtcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0cmFuc2l0aW9uZW5kJywgZW5kU2xpZGVEb3duKTtcbiAgICAgIGVsLnN0eWxlLm1heEhlaWdodCA9ICcwJztcbiAgICAgIGVsLnN0eWxlLm9wYWNpdHkgPSAnMCc7XG4gICAgfSk7XG4gIH1cbiAgd2luZG93LnZpZXdwb3J0U2l6ZSA9IHt9O1xuICBcbiAgd2luZG93LnZpZXdwb3J0U2l6ZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gIFx0cmV0dXJuIGdldFNpemUoXCJIZWlnaHRcIik7XG4gIH07XG4gIFxuICB3aW5kb3cudmlld3BvcnRTaXplLmdldFdpZHRoID0gZnVuY3Rpb24gKCkge1xuICBcdHJldHVybiBnZXRTaXplKFwiV2lkdGhcIik7XG4gIH07XG4gIFxuICB2YXIgZ2V0U2l6ZSA9IGZ1bmN0aW9uIChOYW1lKSB7XG4gIFx0dmFyIHNpemU7XG4gIFx0dmFyIG5hbWUgPSBOYW1lLnRvTG93ZXJDYXNlKCk7XG4gIFx0dmFyIGRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50O1xuICBcdHZhciBkb2N1bWVudEVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gIFx0aWYgKHdpbmRvd1tcImlubmVyXCIgKyBOYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gIFx0XHQvLyBJRTYgJiBJRTcgZG9uJ3QgaGF2ZSB3aW5kb3cuaW5uZXJXaWR0aCBvciBpbm5lckhlaWdodFxuICBcdFx0c2l6ZSA9IGRvY3VtZW50RWxlbWVudFtcImNsaWVudFwiICsgTmFtZV07XG4gIFx0fVxuICBcdGVsc2UgaWYgKHdpbmRvd1tcImlubmVyXCIgKyBOYW1lXSAhPSBkb2N1bWVudEVsZW1lbnRbXCJjbGllbnRcIiArIE5hbWVdKSB7XG4gIFx0XHQvLyBXZWJLaXQgZG9lc24ndCBpbmNsdWRlIHNjcm9sbGJhcnMgd2hpbGUgY2FsY3VsYXRpbmcgdmlld3BvcnQgc2l6ZSBzbyB3ZSBoYXZlIHRvIGdldCBmYW5jeVxuICBcbiAgXHRcdC8vIEluc2VydCBtYXJrdXAgdG8gdGVzdCBpZiBhIG1lZGlhIHF1ZXJ5IHdpbGwgbWF0Y2ggZG9jdW1lbnQuZG91bWVudEVsZW1lbnRbXCJjbGllbnRcIiArIE5hbWVdXG4gIFx0XHR2YXIgYm9keUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYm9keVwiKTtcbiAgXHRcdGJvZHlFbGVtZW50LmlkID0gXCJ2cHctdGVzdC1iXCI7XG4gIFx0XHRib2R5RWxlbWVudC5zdHlsZS5jc3NUZXh0ID0gXCJvdmVyZmxvdzpzY3JvbGxcIjtcbiAgXHRcdHZhciBkaXZFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgXHRcdGRpdkVsZW1lbnQuaWQgPSBcInZwdy10ZXN0LWRcIjtcbiAgXHRcdGRpdkVsZW1lbnQuc3R5bGUuY3NzVGV4dCA9IFwicG9zaXRpb246YWJzb2x1dGU7dG9wOi0xMDAwcHhcIjtcbiAgXHRcdC8vIEdldHRpbmcgc3BlY2lmaWMgb24gdGhlIENTUyBzZWxlY3RvciBzbyBpdCB3b24ndCBnZXQgb3ZlcnJpZGRlbiBlYXNpbHlcbiAgXHRcdGRpdkVsZW1lbnQuaW5uZXJIVE1MID0gXCI8c3R5bGU+QG1lZGlhKFwiICsgbmFtZSArIFwiOlwiICsgZG9jdW1lbnRFbGVtZW50W1wiY2xpZW50XCIgKyBOYW1lXSArIFwicHgpe2JvZHkjdnB3LXRlc3QtYiBkaXYjdnB3LXRlc3QtZHtcIiArIG5hbWUgKyBcIjo3cHghaW1wb3J0YW50fX08L3N0eWxlPlwiO1xuICBcdFx0Ym9keUVsZW1lbnQuYXBwZW5kQ2hpbGQoZGl2RWxlbWVudCk7XG4gIFx0XHRkb2N1bWVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKGJvZHlFbGVtZW50LCBkb2N1bWVudC5oZWFkKTtcbiAgXG4gIFx0XHRpZiAoZGl2RWxlbWVudFtcIm9mZnNldFwiICsgTmFtZV0gPT0gNykge1xuICBcdFx0XHQvLyBNZWRpYSBxdWVyeSBtYXRjaGVzIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudFtcImNsaWVudFwiICsgTmFtZV1cbiAgXHRcdFx0c2l6ZSA9IGRvY3VtZW50RWxlbWVudFtcImNsaWVudFwiICsgTmFtZV07XG4gIFx0XHR9XG4gIFx0XHRlbHNlIHtcbiAgXHRcdFx0Ly8gTWVkaWEgcXVlcnkgZGlkbid0IG1hdGNoLCB1c2Ugd2luZG93W1wiaW5uZXJcIiArIE5hbWVdXG4gIFx0XHRcdHNpemUgPSB3aW5kb3dbXCJpbm5lclwiICsgTmFtZV07XG4gIFx0XHR9XG4gIFx0XHQvLyBDbGVhbnVwXG4gIFx0XHRkb2N1bWVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoYm9keUVsZW1lbnQpO1xuICBcdH1cbiAgXHRlbHNlIHtcbiAgXHRcdC8vIERlZmF1bHQgdG8gdXNlIHdpbmRvd1tcImlubmVyXCIgKyBOYW1lXVxuICBcdFx0c2l6ZSA9IHdpbmRvd1tcImlubmVyXCIgKyBOYW1lXTtcbiAgXHR9XG4gIFx0cmV0dXJuIHNpemU7XG4gIH07XG5cblxuXG4vKlxuICogQ3VzdG9tXG4gKi9cbiBjbGFzcyBEcm9wZG93biB7XG4gICBjb25zdHJ1Y3Rvcihjb250YWluZXIpIHtcbiAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgIHRoaXMuY29udGVudHMgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuanMtZHJvcGRvd24taXRlbS1jb250ZW50Jyk7XG4gICAgIHRoaXMubGlua3MgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuanMtZHJvcGRvd24taXRlbS1saW5rJyk7XG4gICAgIHRoaXMuaW5pdCgpO1xuICAgfVxuIFxuICAgaW5pdCgpIHtcbiAgICAgdGhpcy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnVwZGF0ZURyb3Bkb3duLmJpbmQodGhpcykpO1xuICAgfVxuIFxuICAgdXBkYXRlRHJvcGRvd24oZSkge1xuICAgICBsZXQgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gXG4gICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1kcm9wZG93bi1pdGVtLWxpbmsnKSkge1xuICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICBsZXQgcGFyZW50ID0gdGFyZ2V0LmNsb3Nlc3QoJy5qcy1kcm9wZG93bi1pdGVtJyksXG4gICAgICAgICAgIGNvbnRlbnQgPSBwYXJlbnQucXVlcnlTZWxlY3RvcignLmpzLWRyb3Bkb3duLWl0ZW0tY29udGVudCcpO1xuIFxuICAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdpcy1hY3RpdmUnKSkge1xuICAgICAgICAgdGhpcy5jbGVhckRyb3Bkb3duKCk7XG4gICAgICAgfSBlbHNlIHtcbiAgICAgICAgIHRoaXMuY2xlYXJEcm9wZG93bigpO1xuICAgICAgICAgdGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xuICAgICAgICAgc2xpZGVEb3duKGNvbnRlbnQpO1xuICAgICAgIH1cbiAgICAgfVxuICAgfVxuIFxuICAgY2xlYXJEcm9wZG93bigpIHtcbiAgICAgZm9yICh2YXIgZWxlbWVudCBvZiB0aGlzLmxpbmtzKSB7XG4gICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKTtcbiAgICAgfVxuICAgICBmb3IgKHZhciBlbGVtZW50IG9mIHRoaXMuY29udGVudHMpIHtcbiAgICAgICBzbGlkZVVwKGVsZW1lbnQpO1xuICAgICB9XG4gICB9XG4gfVxuIGNsYXNzIE1lbnUge1xuICAgY29uc3RydWN0b3IoY29udGFpbmVyKSB7XG4gICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgICB0aGlzLm1lbnVTY3JvbGwgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuanMtbWVudS1zY3JvbGwnKTtcbiAgICAgdGhpcy5tZW51U2Nyb2xsVGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLW1lbnUtc2hvdycpO1xuICAgICB0aGlzLm1lbnVNb2JpbGUgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuanMtbWVudS1tb2JpbGUnKTtcbiAgICAgdGhpcy5tZW51TW9iaWxlVG9nZ2xlID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLmpzLW1lbnUtbW9iaWxlLXRvZ2dsZScpO1xuICAgICB0aGlzLmluaXQoKTtcbiAgIH1cbiBcbiAgIGluaXQoKSB7XG4gICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLmNoZWNrTWVudVBvc2l0aW9uLmJpbmQodGhpcykpO1xuICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5jaGVja01lbnVQb3NpdGlvbi5iaW5kKHRoaXMpKTtcbiAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuc2Nyb2xsVG9FbGVtZW50LmJpbmQodGhpcykpO1xuICAgICB0aGlzLm1lbnVNb2JpbGVUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnRvZ2dsZU1vYmlsZU1lbnUuYmluZCh0aGlzKSk7XG4gICB9XG4gXG4gICBjaGVja01lbnVQb3NpdGlvbigpIHtcbiAgICAgbGV0IHRhcmdldFBvc2l0aW9uID0gdGhpcy5tZW51U2Nyb2xsVGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgdGFyZ2V0UG9zaXRpb25Ub3AgPSB0YXJnZXRQb3NpdGlvbi50b3A7XG4gXG4gICAgIGlmICh0YXJnZXRQb3NpdGlvblRvcCA8IDApIHtcbiAgICAgICB0aGlzLm1lbnVTY3JvbGwuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XG4gICAgIH0gZWxzZSB7XG4gICAgICAgdGhpcy5tZW51U2Nyb2xsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xuICAgICB9XG4gICB9XG4gXG4gICBzY3JvbGxUb0VsZW1lbnQoZSkge1xuICAgICBsZXQgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gXG4gICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1tZW51LWxpbmstc2Nyb2xsJykpIHtcbiAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgbGV0IG1lbnVfaGVpZ2h0ID0gNjU7XG4gICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLW1lbnUtbGluay1zY3JvbGwtbm8tbWVudScpKSB7XG4gICAgICAgICBtZW51X2hlaWdodCA9IDA7XG4gICAgICAgfVxuICAgICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQuZ2V0QXR0cmlidXRlKCdocmVmJykpLFxuICAgICAgICAgICB0YXJnZXRQb3NpdGlvbiA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgIHRhcmdldFBvc2l0aW9uVG9wID0gdGFyZ2V0UG9zaXRpb24udG9wICsgd2luZG93LnBhZ2VZT2Zmc2V0IC0gbWVudV9oZWlnaHQ7XG4gXG4gICAgICAgc2Nyb2xsVG8odGFyZ2V0UG9zaXRpb25Ub3AsIDEwMDApO1xuIFxuICAgICAgIHRoaXMubWVudU1vYmlsZVRvZ2dsZS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKTtcbiAgICAgICB0aGlzLm1lbnVNb2JpbGUuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XG4gICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdtZW51LW9wZW5lZCcpO1xuICAgICB9XG4gICB9XG4gXG4gICB0b2dnbGVNb2JpbGVNZW51KGUpIHtcbiAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICBsZXQgdGFyZ2V0Q2xhc3NMaXN0ID0gdGhpcy5tZW51TW9iaWxlVG9nZ2xlLmNsYXNzTGlzdCxcbiAgICAgICAgIG1lbnVDbGFzc0xpc3QgPSB0aGlzLm1lbnVNb2JpbGUuY2xhc3NMaXN0LFxuICAgICAgICAgYm9keUNsYXNzTGlzdCA9IGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0O1xuIFxuICAgICBpZiAodGFyZ2V0Q2xhc3NMaXN0LmNvbnRhaW5zKCdpcy1hY3RpdmUnKSkge1xuICAgICAgIHRhcmdldENsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xuICAgICAgIG1lbnVDbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKTtcbiAgICAgICBib2R5Q2xhc3NMaXN0LnJlbW92ZSgnbWVudS1vcGVuZWQnKTtcbiAgICAgfSBlbHNlIHtcbiAgICAgICB0YXJnZXRDbGFzc0xpc3QuYWRkKCdpcy1hY3RpdmUnKTtcbiAgICAgICBtZW51Q2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XG4gICAgICAgYm9keUNsYXNzTGlzdC5hZGQoJ21lbnUtb3BlbmVkJyk7XG4gICAgIH1cbiAgIH1cbiB9XG4gY2xhc3MgU2xpZGVUb2dnbGUge1xuICAgY29uc3RydWN0b3IoY29udGFpbmVyKSB7XG4gICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgICB0aGlzLmNvbnRlbnQgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuanMtc2xpZGVUb2dnbGUtY29udGVudCcpO1xuICAgICB0aGlzLmJ1dHRvbiA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5qcy1zbGlkZVRvZ2dsZS1idXR0b24nKTtcbiAgICAgdGhpcy5XSURUSF9NT0JJTEUgPSA3Njc7XG4gICAgIHRoaXMuaW5pdCgpO1xuICAgfVxuIFxuICAgaW5pdCgpIHtcbiAgICAgdGhpcy5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnRvZ2dsZUNvbnRlbnQuYmluZCh0aGlzKSk7XG4gICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLmNoZWNrVG9nZ2xlUG9zaXRpb24uYmluZCh0aGlzKSk7XG4gICB9XG4gXG4gICB0b2dnbGVDb250ZW50KGUpIHtcbiAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICBsZXQgYnV0dG9uQ2xhc3NMaXN0ID0gdGhpcy5idXR0b24uY2xhc3NMaXN0LFxuICAgICAgICAgY29udGVudENsYXNzTGlzdCA9IHRoaXMuY29udGVudC5jbGFzc0xpc3Q7XG4gXG4gICAgIGlmIChidXR0b25DbGFzc0xpc3QuY29udGFpbnMoJ2lzLWFjdGl2ZScpKSB7XG4gICAgICAgY29udGVudENsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xuICAgICAgIGJ1dHRvbkNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xuICAgICAgIHRoaXMuYnV0dG9uLnRleHRDb250ZW50ID0gJ9C/0L7QutCw0LfQsNGC0Ywg0LLRgdC1JztcbiAgICAgICBzbGlkZVVwKHRoaXMuY29udGVudCk7XG4gICAgIH0gZWxzZSB7XG4gICAgICAgY29udGVudENsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xuICAgICAgIGJ1dHRvbkNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xuICAgICAgIHRoaXMuYnV0dG9uLnRleHRDb250ZW50ID0gJ9GB0LrRgNGL0YLRjCc7XG4gICAgICAgc2xpZGVEb3duKHRoaXMuY29udGVudCk7XG4gICAgIH1cbiAgIH1cbiBcbiAgIGNoZWNrVG9nZ2xlUG9zaXRpb24oKSB7XG4gICAgIC8vIGNvbnNvbGUubG9nKHZpZXdwb3J0U2l6ZS5nZXRXaWR0aCgpKTtcbiAgIH1cbiB9XG4gY2xhc3MgVG9nZ2xlIHtcbiAgIGNvbnN0cnVjdG9yKCkge1xuICAgICB0aGlzLmluaXQoKTtcbiAgIH1cbiBcbiAgIGluaXQoKSB7XG4gICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnRvZ2dsZVN3aXRjaC5iaW5kKHRoaXMpKTtcbiAgIH1cbiBcbiAgIHRvZ2dsZVN3aXRjaChlKSB7XG4gICAgIGxldCB0YXJnZXQgPSBlLnRhcmdldCxcbiAgICAgICAgIHRhcmdldENsYXNzTGlzdCA9IHRhcmdldC5jbGFzc0xpc3Q7XG4gXG4gICAgIGlmICh0YXJnZXRDbGFzc0xpc3QuY29udGFpbnMoJ2pzLXRvZ2dsZS1saW5rJykpIHtcbiAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgbGV0IHBhcmVudCA9IHRhcmdldC5jbG9zZXN0KCcuanMtdG9nZ2xlLWNvbnRhaW5lcicpLFxuICAgICAgICAgICBjb250ZW50ID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy10b2dnbGUtY29udGVudCcpLFxuICAgICAgICAgICBjb250ZW50Q2xhc3NMaXN0ID0gY29udGVudC5jbGFzc0xpc3Q7XG4gXG4gICAgICAgaWYgKHRhcmdldENsYXNzTGlzdC5jb250YWlucygnaXMtYWN0aXZlJykpIHtcbiAgICAgICAgIHRhcmdldENsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xuICAgICAgICAgY29udGVudENsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xuICAgICAgICAgY29udGVudC5zdHlsZS5tYXhIZWlnaHQgPSAnMCc7XG4gICAgICAgfSBlbHNlIHtcbiAgICAgICAgIHRhcmdldENsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xuICAgICAgICAgY29udGVudENsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xuICAgICAgICAgY29udGVudC5zdHlsZS5tYXhIZWlnaHQgPSAnbm9uZSc7XG4gICAgICAgfVxuICAgICB9XG4gICB9XG4gfVxuIGNsYXNzIFRvb2x0aXBzIHtcbiAgIGNvbnN0cnVjdG9yKCkge1xuICAgICB0aGlzLnRvb2x0aXBDb250ZW50cyA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbCgnLmpzLXRvb2x0aXAtY29udGVudCcpO1xuICAgICB0aGlzLnRvb2x0aXBMaW5rcyA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbCgnLmpzLXRvb2x0aXAtbGluaycpO1xuICAgICB0aGlzLmluaXQoKTtcbiAgIH1cbiBcbiAgIGluaXQoKSB7XG4gICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnRvZ2dsZVRvb2x0aXAuYmluZCh0aGlzKSk7XG4gICB9XG4gXG4gICB0b2dnbGVUb29sdGlwKGUpIHtcbiAgICAgbGV0IHRhcmdldCA9IGUudGFyZ2V0O1xuIFxuICAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnanMtdG9vbHRpcC1saW5rJykpIHtcbiAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgbGV0IHBhcmVudCA9IHRhcmdldC5jbG9zZXN0KCcuanMtdG9vbHRpcC1jb250YWluZXInKSxcbiAgICAgICAgICAgY29udGVudCA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCcuanMtdG9vbHRpcC1jb250ZW50Jyk7XG4gXG4gICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLWFjdGl2ZScpKSB7XG4gICAgICAgICB0aGlzLmNsZWFyVG9vbHRpcHMoKTtcbiAgICAgICB9IGVsc2Uge1xuICAgICAgICAgdGhpcy5jbGVhclRvb2x0aXBzKCk7XG4gICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XG4gICAgICAgICBjb250ZW50LmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xuICAgICAgIH1cbiAgICAgfSBlbHNlIHtcbiAgICAgICB0aGlzLmNsZWFyVG9vbHRpcHMoKTtcbiAgICAgfVxuICAgfVxuIFxuICAgY2xlYXJUb29sdGlwcygpIHtcbiAgICAgZm9yICh2YXIgZWxlbWVudCBvZiB0aGlzLnRvb2x0aXBDb250ZW50cykge1xuICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XG4gICAgIH1cbiAgICAgZm9yICh2YXIgZWxlbWVudCBvZiB0aGlzLnRvb2x0aXBMaW5rcykge1xuICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XG4gICAgIH1cbiAgIH1cbiB9XG4gY2xhc3MgVmlld2VyIHtcbiAgIGNvbnN0cnVjdG9yKCkge1xuICAgICB0aGlzLmluaXQoKTtcbiAgIH1cbiBcbiAgIGluaXQoKSB7XG4gICAgIHRoaXMuaW5pdENsYXNzZXMoKTtcbiAgIH1cbiBcbiAgIGluaXRDbGFzc2VzKCkge1xuICAgICBmb3IgKHZhciBlbGVtZW50IG9mIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1kcm9wZG93bi1jb250YWluZXInKSkge1xuICAgICAgIG5ldyBEcm9wZG93bihlbGVtZW50KTtcbiAgICAgfVxuIFxuICAgICBmb3IgKHZhciBlbGVtZW50IG9mIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1tZW51LWNvbnRhaW5lcicpKSB7XG4gICAgICAgbmV3IE1lbnUoZWxlbWVudCk7XG4gICAgIH1cbiBcbiAgICAgZm9yICh2YXIgZWxlbWVudCBvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtc2xpZGVUb2dnbGUtY29udGFpbmVyJykpIHtcbiAgICAgICBuZXcgU2xpZGVUb2dnbGUoZWxlbWVudCk7XG4gICAgIH1cbiBcbiAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy10b29sdGlwLWxpbmsnKS5sZW5ndGgpIHtcbiAgICAgICBuZXcgVG9vbHRpcHMoKTtcbiAgICAgfVxuIFxuICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmpzLXRvZ2dsZS1saW5rJykubGVuZ3RoKSB7XG4gICAgICAgbmV3IFRvZ2dsZSgpO1xuICAgICB9XG4gICB9XG4gfVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBuZXcgVmlld2VyKCk7XG59KTsiXX0=
